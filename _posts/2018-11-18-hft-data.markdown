---
title: Handle High Frequency Data
layout: post
math: true
author: Jon Liu
tags: hft, tick data
---

> This post states several features of high frequency trading data and shows hosts of methods to play with it.

HFT data, or the commonly called tick data, are records of market activity. Two levels of data format complexity is grouped into: Level I data includes the best bid/ask price/size, and last trade price and size, where avaliable. Level II data includes all changes to the order book, including new limit order arrivals and cnacellations at prices away from the market price. etc. [LOBSTER](https://lobsterdata.com/info/DataStructure.php) provides 7 types of events causing an update of the limit order book in the requested price range.

Tick owns multiple meaning in this field. A tick is a measure of the minimum change unit in the price of a security. A tick can also refer to the change in the price of a security from trade to trade: uptick and downtick.

MOs contribute to HFT data in the field of 'last trade' info. They are executed immediately at the best avaliable bid/ask prices when placed. A large MO may need to be matched with one or several best quotes, generating several 'last trade' (represented as 'tp' and 'tq' but without buyer or seller initiated identifiers info for most small tick size tradable assets) data points.

Last trade price can differ from the bid and ask. The differences can arise when a customer posts a favorable limit order that is immediately matched by the broker without broadcasting the customer’s quote.

Most LOs and MOs are placed in so called "lot sizes": increments of certain numbers of units, known as a lot. For example, while commodity futures may enforce a 50 share minimum requirement for orders, a lot can be as low as one share on common equity exchanges.


HF data is irregularly spaced in time. There is a lot literature on dealing with unevenly spaced data. [1] is a good point to get start

## Parsing cumbersome Level II information

## Market making

The market maker’s bids are said to be **hit** by market sell orders (hit the bid), and the market maker’s ask limit orders are said to be **lifted** by incoming market buy orders (lift the ask). The market order traders are known as **liquidity takers**.

Two kinds of risk a market maker could face:
- Inventory risk. Besides the common sense, it also includes the opportunity costs reflecting the gains the market maker misses while waiting for execution of his limit orders.
- Risk of adverse selection. This loss comes from informational difference between the makers and takers.

Too little inventory may be insufficient to generate a profit; too much inventory makes the trader risk inability to quickly liquidate his position and face a certain loss.

Trading frequency has been shown to be key to market makers' profitablity. Market makers’ profit is directly tied to the frequency with which their orders are executed. Denser round-trip trades usually lead to a better performance. The higher the number of times the market maker can “flip” his capital, the higher the cumulative spread the market-maker can capture, and the lower the risk the market maker bears waiting for execution of his orders.

Super-fast technology allows market makers to continually cancel and resubmit their limit orders to ensure their spot on the top of the book, high execution rates, and high profitability. Slower technology can still deliver profitable market-making strategies via larger offsets away from the going market price.

Some market making ideas:
- Fixed-offset.
- Volatility-offset. Make the offset a fucntion of volatiliity: in high vol conditions, LOs far away from the market are likely to be hit, generating higher premium for market makers; in low vol counterpart, LOs may need to be placed closer to the market to be executed. *Realized variance* or *volatility* releated estimator could be helpful, and [here](https://realized.oxford-man.ox.ac.uk/documentation/estimators) is a potential list.

$$
O_t = \frac{1}{T}\sum_{\tau=t-1}^{t-T} (P_{\tau} - P_{\tau - 1})^2
$$

- Order-arrival rate offset. LOs compete with other LOs, both existing and those submitted in the future. Furthermore, all LOs execute against future market orders. The MO arrival rate, therefore, is an important determinant of market-making profitability. Releated models include exponentially-distributed inter-arrival times (OK, Possion in fact), Hawkes process, etc. The core concept here is the arrival rate of MO $\mu$; with $1/\mu$ representing the average time between two sequential MO arrivals, which makes it easier to calibrate.  When the model is used to determine levels of aggressiveness of limit buy orders, $\mu$ is the rate of arrival of market sell orders.

- Differentiation between trending and mean-reverting markets. In a mean-reverting msrket, the price bounces up and down within a range, reducing the risk of adverse selection and making such market conditions perfect for market making. In trending markets, however, a market maker needs to reduce the size of LOs on the wrong side of the markets, hedge the exposure, or exit the markets altogether. Directional analysis need to be performed to determine the hidden regime. Hurst exponent is a good benchmark to test.

- Resistance and support levels. Computing support and resistance helps pinpoint liquidity peaks without parsing cumbersome level II information. Say, we accumulate 1 min bars $$\{B_i\}_{i=1}^t$$, $$p_t=\{p_t^i\}_{i=1}^{t_N}$$ reprs the price sequence in the $t$-th bar. One can update the support/resistance levels:

$$
SL_{t+1} = \min(p_t) + (\min(p_t) - \min(p_{t-1}))
$$

$$
RL_{t+1} = \max(p_t) + (\max(p_t) - \max(p_{t-1}))
$$

## Reference
[1] Eckner, Andreas. "A framework for the analysis of unevenly spaced time series data." Preprint. Available at: http://www.eckner.com/papers/unevenly_spaced_time_series_analysis (2012).
